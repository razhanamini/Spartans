import { BetterPromise, BetterPromiseRejectReason } from 'better-promises';
import { SignDataError, SignDataOptions } from '../signDataFp.js';
import { SignableData, SignOptions } from '../signFp.js';
import { Text } from '../types.js';
import { ValidateValue, ValidateAsyncError, ValidateAsyncOptions } from '../validation.js';
import * as TE from 'fp-ts/TaskEither';
/**
 * Hashes specified token using a string, expected during init data sign.
 * @param token - token to hash.
 */
export declare function hashToken(token: Text): Promise<ArrayBuffer>;
/**
 * @param value - value to check.
 * @param token - bot secret token.
 * @param options - additional validation options.
 * @returns True is specified init data is valid.
 */
export declare function isValidFp(value: ValidateValue, token: Text, options?: ValidateAsyncOptions): TE.TaskEither<BetterPromiseRejectReason, boolean>;
/**
 * @see isValidFp
 */
export declare function isValid(value: ValidateValue, token: Text, options?: ValidateAsyncOptions): BetterPromise<boolean>;
/**
 * Signs specified init data.
 * @param data - init data to sign.
 * @param authDate - date, when this init data should be signed.
 * @param key - private key.
 * @param options - additional options.
 * @returns Signed init data presented as query parameters.
 */
export declare function signFp(data: SignableData, key: Text, authDate: Date, options?: SignOptions): TE.TaskEither<SignDataError, string>;
/**
 * @see signFp
 */
export declare function sign(data: SignableData, key: Text, authDate: Date, options?: SignOptions): BetterPromise<string>;
/**
 * Signs specified data with the passed token.
 * @param data - data to sign.
 * @param key - private key.
 * @param options - additional options.
 * @returns Data sign.
 */
export declare function signDataFp(data: Text, key: Text, options?: SignDataOptions): TE.TaskEither<SignDataError, string>;
/**
 * @see signDataFp
 */
export declare function signData(data: Text, key: Text, options?: SignDataOptions): BetterPromise<string>;
/**
 * Validates passed init data.
 * @param value - value to check.
 * @param token - bot secret token.
 * @param options - additional validation options.
 */
export declare function validateFp(value: ValidateValue, token: Text, options?: ValidateAsyncOptions): TE.TaskEither<ValidateAsyncError, void>;
/**
 * @see validateFp
 */
export declare function validate(value: ValidateValue, token: Text, options?: ValidateAsyncOptions): BetterPromise<void>;
export * from './shared.js';
